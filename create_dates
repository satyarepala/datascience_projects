from datetime import datetime, timedelta

# Define the start date and the end date (30 days before today)
start_date = datetime(2024, 7, 1)
end_date = datetime.today() - timedelta(days=30)

# Function to get the start and end dates of each month
def generate_month_ranges(start_date, end_date):
    months = []
    current_date = start_date
    while current_date <= end_date:
        month_start = current_date.replace(day=1)
        next_month = (month_start.month % 12) + 1
        year = month_start.year + (1 if month_start.month == 12 else 0)
        month_end = datetime(year, next_month, 1) - timedelta(days=1)
        if month_end > end_date:
            month_end = end_date
        months.append((month_start, month_end))
        current_date = month_end + timedelta(days=1)
    return months

# Function to get the start and end dates of each quarter
def generate_quarter_ranges(start_date, end_date):
    quarters = []
    current_date = start_date
    while current_date <= end_date:
        quarter_start = current_date.replace(month=(current_date.month - 1) // 3 * 3 + 1, day=1)
        next_quarter_month = (quarter_start.month - 1 + 3) % 12 + 1
        year = quarter_start.year + (1 if quarter_start.month > 9 else 0)
        quarter_end = datetime(year, next_quarter_month, 1) - timedelta(days=1)
        if quarter_end > end_date:
            quarter_end = end_date
        quarters.append((quarter_start, quarter_end))
        current_date = quarter_end + timedelta(days=1)
    return quarters

# Generate ranges
month_ranges = generate_month_ranges(start_date, end_date)
quarter_ranges = generate_quarter_ranges(start_date, end_date)

# Display results
print("Month Ranges:")
for start, end in month_ranges:
    print(f"{start.date()} to {end.date()}")

print("\nQuarter Ranges:")
for start, end in quarter_ranges:
    print(f"{start.date()} to {end.date()}")
